<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Flashcard Quiz App — Enhanced</title>
<style>
    :root {
        --bg: #f5f7fb;
        --card-bg: #ffffff;
        --accent: #2b8cff;
        --danger: #e74c3c;
        --muted: #7a869a;
    }
    body {
        margin: 0;
        font-family: Inter, Roboto, Arial, sans-serif;
        background: linear-gradient(180deg,#eef4ff 0%,var(--bg) 100%);
        display: flex;
        align-items: flex-start;
        justify-content: center;
        min-height: 100vh;
        padding: 32px;
        box-sizing: border-box;
    }
    .app {
        width: 920px;
        max-width: 100%;
        display: grid;
        grid-template-columns: 1fr 380px;
        gap: 20px;
    }
    .panel {
        background: var(--card-bg);
        border-radius: 12px;
        box-shadow: 0 6px 20px rgba(20,40,80,0.08);
        padding: 18px;
    }

   
    .card-area { display:flex; flex-direction:column; gap:12px; align-items:stretch; }
    .header {
        display:flex;
        justify-content:space-between;
        align-items:center;
        gap:12px;
    }
    .title { font-size:18px; font-weight:600; }
    .meta { color:var(--muted); font-size:13px; }

    .flashcard-wrap {
        perspective: 1000px;
        width:100%;
        height:220px;
        display:flex;
        align-items:center;
        justify-content:center;
    }
    .flashcard {
        width:100%;
        height:100%;
        border-radius:10px;
        background: linear-gradient(180deg,#ffffff,#fbfcff);
        border: 1px solid rgba(30,60,120,0.06);
        display:flex;
        align-items:center;
        justify-content:center;
        text-align:center;
        padding:20px;
        box-sizing:border-box;
        font-size:20px;
        color:#172033;
        transform-style: preserve-3d;
        transition: transform 420ms cubic-bezier(.2,.9,.3,1);
        position:relative;
    }
    .flashcard.flipped { transform: rotateY(180deg); }
    .face {
        position:absolute;
        inset:0;
        backface-visibility: hidden;
        display:flex;
        align-items:center;
        justify-content:center;
        padding:22px;
    }
    .face.back { transform: rotateY(180deg); }

    .controls-row { display:flex; gap:8px; flex-wrap:wrap; justify-content:center; }
    button {
        background:var(--accent);
        color:#fff;
        border: none;
        padding:9px 12px;
        border-radius:8px;
        cursor:pointer;
        font-weight:600;
        font-size:14px;
    }
    button.ghost {
        background:transparent;
        color:var(--accent);
        border:1px solid rgba(43,140,255,0.12);
    }
    button.danger {
        background:var(--danger);
    }
    .small { padding:7px 10px; font-size:13px; border-radius:7px; }

   
    .editor { display:flex; flex-direction:column; gap:10px; }
    label { font-size:13px; color:var(--muted); }
    input[type="text"], textarea {
        width:100%;
        padding:10px;
        border-radius:8px;
        border:1px solid rgba(30,40,60,0.08);
        font-size:14px;
        box-sizing:border-box;
        resize:vertical;
    }
    .row { display:flex; gap:8px; }
    .stats { display:flex; gap:10px; align-items:center; color:var(--muted); font-size:13px; }
    .import-area { height:90px; }

    footer.note { margin-top:8px; color:var(--muted); font-size:12px; text-align:center; }

    @media (max-width: 880px) {
        .app { grid-template-columns: 1fr; padding-bottom:32px; gap:12px; }
        .flashcard-wrap { height:200px; }
    }
</style>
</head>
<body>
<div class="app">
    <div class="panel card-area">
        <div class="header">
            <div>
                <div class="title">Flashcard Quiz</div>
                <div class="meta" id="metaText">No cards yet</div>
            </div>
            <div class="stats" id="globalStats">
                <!-- dynamic -->
            </div>
        </div>

        <div class="flashcard-wrap">
            <div class="flashcard" id="flashcard">
                <div class="face front" id="cardFront">No flashcards yet</div>
                <div class="face back" id="cardBack"></div>
            </div>
        </div>

        <div class="controls-row" style="justify-content:space-between; align-items:center;">
            <div style="display:flex; gap:8px;">
                <button onclick="prevCard()" title="Previous (←)">← Prev</button>
                <button onclick="toggleFlip()" id="flipBtn" title="Show/Hide Answer (Space)">Show Answer</button>
                <button onclick="nextCard()" title="Next (→)">Next →</button>
            </div>

            <div style="display:flex; gap:8px;">
                <button class="ghost small" onclick="shuffleCards()" title="Shuffle">Shuffle</button>
                <button class="ghost small" onclick="clearAll()" title="Clear all cards">Clear All</button>
            </div>
        </div>

        <div style="display:flex;gap:8px;justify-content:center;margin-top:6px;">
            <button onclick="markCorrect()" class="small" title="Mark correct">Mark Correct ✓</button>
            <button onclick="markIncorrect()" class="small" title="Mark incorrect">Mark Incorrect ✗</button>
            <div id="cardScore" class="meta" style="align-self:center;"></div>
        </div>

        <footer class="note">Keyboard: ← Prev, → Next, Space Flip, E edit current</footer>
    </div>

    <div class="panel editor">
        <div style="display:flex;justify-content:space-between;align-items:center;">
            <div style="font-weight:600">Add / Edit Flashcard</div>
            <div class="meta" id="indexLabel">0 / 0</div>
        </div>

        <div>
            <label for="questionInput">Question</label>
            <input id="questionInput" type="text" placeholder="Type the question (or prompt)">
        </div>

        <div>
            <label for="answerInput">Answer</label>
            <textarea id="answerInput" rows="4" placeholder="Type the answer"></textarea>
        </div>

        <div class="row">
            <button onclick="addOrUpdateCard()">Add / Update</button>
            <button class="ghost" onclick="loadCurrentToEditor()">Load Current</button>
            <button class="danger" onclick="deleteCurrent()">Delete</button>
        </div>

        <hr />

        <div>
            <div style="display:flex;justify-content:space-between;align-items:center;">
                <div style="font-weight:600">Import / Export</div>
                <div class="meta">Local storage</div>
            </div>
            <textarea id="importExport" class="import-area" placeholder="Paste JSON to import or click Export"></textarea>
            <div style="display:flex;gap:8px;margin-top:8px;">
                <button class="ghost" onclick="exportJSON()">Export JSON</button>
                <button class="ghost" onclick="importJSON()">Import JSON</button>
                <button onclick="downloadJSON()" title="Download JSON file">Download</button>
            </div>
        </div>

        <div style="margin-top:8px;">
            <div style="display:flex;justify-content:space-between;align-items:center;">
                <div style="font-weight:600">Stats</div>
                <div class="meta" id="statTotals">0 cards • 0 correct recorded</div>
            </div>
        </div>
    </div>
</div>

<script>
const STORAGE_KEY = 'flashcards-v1';
let flashcards = [];
let currentIndex = 0;
let flipped = false;

function save() {
    localStorage.setItem(STORAGE_KEY, JSON.stringify(flashcards));
    refreshUI();
}

function load() {
    const raw = localStorage.getItem(STORAGE_KEY);
    if (raw) {
        try {
            flashcards = JSON.parse(raw) || [];
        } catch(e) {
            flashcards = [];
            console.error('Failed to parse stored flashcards', e);
        }
    } else {
        flashcards = [];
    }
    if (currentIndex >= flashcards.length) currentIndex = Math.max(0, flashcards.length - 1);
    refreshUI();
}

function refreshUI() {
    const total = flashcards.length;
    const meta = document.getElementById('metaText');
    const indexLabel = document.getElementById('indexLabel');
    const globalStats = document.getElementById('globalStats');
    const statTotals = document.getElementById('statTotals');

    if (total === 0) {
        meta.textContent = 'No cards yet';
        indexLabel.textContent = '0 / 0';
    } else {
        meta.textContent = `Card ${currentIndex + 1} of ${total}`;
        indexLabel.textContent = `${currentIndex + 1} / ${total}`;
    }

    const totalCorrect = flashcards.reduce((s, c) => s + (c.correct || 0), 0);
    globalStats.innerHTML = `<span style="font-weight:600;">${total}</span> cards`;
    statTotals.textContent = `${total} cards • ${totalCorrect} total correct`;

    updateCardDisplay();
}

function updateCardDisplay() {
    const front = document.getElementById('cardFront');
    const back = document.getElementById('cardBack');
    const card = document.getElementById('flashcard');
    const cardScore = document.getElementById('cardScore');

    if (flashcards.length === 0) {
        front.textContent = 'No flashcards yet';
        back.textContent = '';
        card.classList.remove('flipped');
        flipped = false;
        document.getElementById('flipBtn').textContent = 'Show Answer';
        cardScore.textContent = '';
        return;
    }

    const c = flashcards[currentIndex];
    front.textContent = c.question || '(no question)';
    back.textContent = c.answer || '(no answer)';

    if (flipped) {
        card.classList.add('flipped');
        document.getElementById('flipBtn').textContent = 'Hide Answer';
    } else {
        card.classList.remove('flipped');
        document.getElementById('flipBtn').textContent = 'Show Answer';
    }

    const correct = c.correct || 0;
    const incorrect = c.incorrect || 0;
    cardScore.textContent = `✓ ${correct} • ✗ ${incorrect}`;
}

function toggleFlip() {
    if (flashcards.length === 0) return;
    flipped = !flipped;
    updateCardDisplay();
}

function nextCard() {
    if (flashcards.length === 0) return;
    currentIndex = (currentIndex + 1) % flashcards.length;
    flipped = false;
    refreshUI();
}

function prevCard() {
    if (flashcards.length === 0) return;
    currentIndex = (currentIndex - 1 + flashcards.length) % flashcards.length;
    flipped = false;
    refreshUI();
}

function addOrUpdateCard() {
    const q = document.getElementById('questionInput').value.trim();
    const a = document.getElementById('answerInput').value.trim();

    if (!q || !a) {
        alert('Enter both question and answer.');
        return;
    }

    
    if (flashcards.length > 0 && document.getElementById('questionInput').dataset.editIndex === 'current') {
        flashcards[currentIndex].question = q;
        flashcards[currentIndex].answer = a;
       
        flashcards.push({ question: q, answer: a, correct: 0, incorrect: 0 });
        currentIndex = flashcards.length - 1;
    }

    
    document.getElementById('questionInput').value = '';
    document.getElementById('answerInput').value = '';
    document.getElementById('questionInput').removeAttribute('data-edit-index');

    flipped = false;
    save();
}

function loadCurrentToEditor() {
    if (flashcards.length === 0) {
        alert('No cards to load.');
        return;
    }
    const c = flashcards[currentIndex];
    document.getElementById('questionInput').value = c.question || '';
    document.getElementById('answerInput').value = c.answer || '';
    // set a flag to indicate save will update current instead of adding new
    document.getElementById('questionInput').dataset.editIndex = 'current';
    document.getElementById('questionInput').focus();
}

function deleteCurrent() {
    if (flashcards.length === 0) return;
    if (!confirm('Delete current card?')) return;
    flashcards.splice(currentIndex, 1);
    if (currentIndex >= flashcards.length) currentIndex = Math.max(0, flashcards.length - 1);
    save();
}

function clearAll() {
    if (!confirm('Clear all flashcards from local storage?')) return;
    flashcards = [];
    currentIndex = 0;
    save();
}

function shuffleCards() {
    for (let i = flashcards.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [flashcards[i], flashcards[j]] = [flashcards[j], flashcards[i]];
    }
    currentIndex = 0;
    save();
}

function markCorrect() {
    if (flashcards.length === 0) return;
    flashcards[currentIndex].correct = (flashcards[currentIndex].correct || 0) + 1;
    save();
    flipped = false;
}

function markIncorrect() {
    if (flashcards.length === 0) return;
    flashcards[currentIndex].incorrect = (flashcards[currentIndex].incorrect || 0) + 1;
    save();
    flipped = false;
}


function exportJSON() {
    document.getElementById('importExport').value = JSON.stringify(flashcards, null, 2);
    alert('Exported JSON to the textarea below. You can copy it or click Download.');
}
function importJSON() {
    const raw = document.getElementById('importExport').value.trim();
    if (!raw) { alert('Paste JSON into the textarea to import.'); return; }
    try {
        const parsed = JSON.parse(raw);
        if (!Array.isArray(parsed)) throw new Error('JSON must be an array of flashcards');
        // normalize entries
        flashcards = parsed.map(c => ({
            question: String(c.question || ''),
            answer: String(c.answer || ''),
            correct: Number(c.correct || 0),
            incorrect: Number(c.incorrect || 0)
        }));
        currentIndex = 0;
        save();
        alert('Imported ' + flashcards.length + ' cards.');
    } catch (e) {
        alert('Import failed: ' + e.message);
    }
}
function downloadJSON() {
    const data = JSON.stringify(flashcards, null, 2);
    const blob = new Blob([data], { type: 'application/json' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = 'flashcards.json';
    document.body.appendChild(a);
    a.click();
    a.remove();
    URL.revokeObjectURL(url);
}


document.addEventListener('keydown', (e) => {
    if (e.target && (e.target.tagName === 'INPUT' || e.target.tagName === 'TEXTAREA')) {
        // allow typing
        if (e.key === 'Escape') e.target.blur();
        if (e.key === 'e' && e.ctrlKey) e.preventDefault();
        return;
    }
    if (e.key === 'ArrowRight') nextCard();
    if (e.key === 'ArrowLeft') prevCard();
    if (e.key === ' ' || e.code === 'Space') { e.preventDefault(); toggleFlip(); }
    if (e.key.toLowerCase() === 'e') loadCurrentToEditor();
});


load();
</script>
</body>
</html>
